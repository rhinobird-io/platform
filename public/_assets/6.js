webpackJsonp([6],{1770:function(e,t,n){"use strict";var A=function(e){return e&&e.__esModule?e["default"]:e},r=A(n(93)),i=A(n(97));e.exports={updateUserData:function(){r.dispatch({type:i.ActionTypes.USER_UPDATE})}}},1855:function(e,t,n){"use strict";var A=n(111),r=n(260),i=n(358),o=(n(438),n(307)),a=r.Link,s=(r.Navigation,n(355).Selector,n(306)),c=(n(1856),n(351).MemberSelect),g=n(92),u=n(1770);n(1859),e.exports=A.createClass({displayName:"index",mixins:[A.addons.LinkedStateMixin],contextTypes:{router:A.PropTypes.func.isRequired},errorMsg:{titleRequired:"Event title is required.",descriptionRequired:"Event description is required."},componentDidMount:function(){this.refs.teamName.focus()},getInitialState:function(){return{}},render:function(){({repeated:{overflow:"hidden",transition:"all 500ms",opacity:this.state.editRepeated?1:0,width:this.state.editRepeated?"552px":"0",height:"100%"}});return A.createElement(s,{style:{height:"100%",position:"relative"}},A.createElement(o.Layout,{horizontal:!0,centerJustified:!0,wrap:!0},A.createElement("form",{onSubmit:this._handleSubmit},A.createElement(i.Paper,{zDepth:3,className:"create-team"},A.createElement("div",{style:{padding:24,width:400}},A.createElement("h3",null,"Create Team"),A.createElement(i.TextField,{ref:"teamName",hintText:"Team name",floatingLabelText:"Name",errorText:this.state.nameError,valueLink:this.linkState("name"),className:"create-team-textfield"}),A.createElement(c,{label:"Parent teams",errorText:this.state.graphError,valueLink:this.linkState("parentTeams"),user:!1,className:"create-team-textfield"}),A.createElement(c,{label:"Subsidiary teams",errorText:this.state.graphError,valueLink:this.linkState("subTeams"),user:!1,className:"create-team-textfield"}),A.createElement(c,{label:"Direct members",valueLink:this.linkState("members"),team:!1,className:"create-team-textfield"}),A.createElement(o.Layout,{horizontal:!0,justified:!0},A.createElement(a,{to:"team"},A.createElement(i.RaisedButton,{label:"Cancel"})),A.createElement(i.RaisedButton,{type:"submit",label:"Create Team",primary:!0})))))))},_handleSubmit:function(e){var t=this;return e.preventDefault(),this.setState({nameError:void 0,graphError:void 0}),this.state.name?g.checkDAG({parentTeams:this.state.parentTeams,teams:this.state.subTeams})?void $.post("/platform/api/teams",{name:this.state.name,parentTeams:this.state.parentTeams,teams:this.state.subTeams,members:this.state.members}).then(function(){u.updateUserData(),t.context.router.transitionTo("/platform/team")}).fail(function(){}):void this.setState({graphError:"Cyclic team structure detected"}):void this.setState({nameError:"Name should not be empty"})}})},1856:function(e,t,n){"use strict";var A=n(93),r=n(1857),i=n(97).CalendarActionTypes;n(1858),e.exports={receive:function(e){$.get("/platform/api/events").done(function(t){A.dispatch({type:i.RECEIVE_EVENTS,data:t}),e&&"function"==typeof e&&e()}).fail(function(e){console.error(e)})},receiveSingle:function(e,t){var n=r.getEvent(e,t);null!==n?A.dispatch({type:i.RECEIVE_EVENT,data:n}):$.get("/platform/api/events/"+e+"/"+t).done(function(e){A.dispatch({type:i.RECEIVE_EVENT,data:e})}).fail(function(e){console.error(e)})},deleteNoRepeatEvent:function(e,t){$.ajax({url:"/platform/api/events/"+e,type:"delete"}).done(function(){A.dispatch({type:i.DELETE_EVENT,data:{id:e}}),t&&"function"==typeof t&&t()}).fail(function(e){console.log(e)}).always(function(){console.log("always")})},undoLastDeletion:function(e,t){var n=e.id,r=e.repeatedNumber;if(n){var o="/platform/api/events/restore/"+n;r&&(o+="/"+r),$.ajax({url:o,type:"put"}).done(function(e){A.dispatch({type:i.RESTORE_DELETED_EVENT,data:e}),t&&"function"==typeof t&&t()}).fail(function(e){console.log(e)}).always(function(){console.log("always")})}},loadMoreOlderEvents:function(e,t,n){$.get("/platform/api/events/before/"+e).done(function(e){A.dispatch({type:i.LOAD_MORE_OLDER_EVENTS,data:e}),t&&"function"==typeof t&&t()}).fail(function(e){console.error(e)})},loadMoreNewerEvents:function(e,t,n){$.get("/platform/api/events/after/"+e).done(function(e){A.dispatch({type:i.LOAD_MORE_NEWER_EVENTS,data:e})}).fail(function(e){404==e.status})},create:function(e,t,n){var r={},o=new Date(e.fromTime),a=new Date(e.toTime);r.title=e.title,r.description=e.description,r.full_day=e.fullDay,r.full_day||(o.setHours(e.fromHour),o.setMinutes(e.fromMinute)),e.isPeriod?(r.period=!0,a.setHours(e.toHour),a.setMinutes(e.toMinute)):(r.period=!1,a=o),r.from_time=o.toISOString(),r.to_time=a.toISOString(),r.participants=e.participants,e.repeated?(r.repeated=!0,r.repeated_type=e.repeatedType,r.repeated_frequency=e.repeatedFrequency,r.repeated_on=e.repeatedOn,r.repeated_by=e.repeatedBy,r.repeated_times=e.repeatedTimes,r.repeated_end_type=e.repeatedEndType,r.repeated_end_date=e.repeatedEndDate):r.repeated=!1,$.post("/platform/api/events",r).done(function(e){A.dispatch({type:i.CREATE_EVENT,data:e}),t&&"function"==typeof t&&t()}).fail(function(e){console.error(e)})}}},1857:function(e,t,n){"use strict";function A(e,t){var n=o(e.from_time);return l[n]||(l[n]={}),u[e.id.toString()]&&u[e.id.toString()][e.repeated_number.toString()]||(l[n][e.id.toString()]=e,u[e.id.toString()]||(u[e.id.toString()]={}),u[e.id.toString()][e.repeated_number.toString()]=e),t&&t===s.CREATE_EVENT?(E=e.id.toString(),void setTimeout(function(){E=null,B.emitChange()},2e3)):(void 0===d.min?d.min=e.from_time:e.from_time<d.min&&(d.min=e.from_time),void(void 0===d.max?d.max=e.from_time:e.from_time>d.max&&(d.max=e.from_time)))}function r(e){for(var t=0;t<e.length;t++)A(e[t])}function i(e){var t=e.id,n=e.repeatedNumber;if(void 0===n||null===n){var A=u[t][1];if(null!==A){var r=o(A.from_time);delete l[r][A.id.toString()],delete u[t],0===Object.keys(l[r]).length&&delete l[r]}C={id:t}}else C={id:t,repeatedNumber:n}}function o(e){var t=new Date(e),n=t.getFullYear().toString(),A=(t.getMonth()+1).toString(),r=t.getDate().toString();return n+"-"+(A[1]?A:"0"+A[0])+"-"+(r[1]?r:"0"+r[0])}var a=n(93),s=n(97).CalendarActionTypes,c=n(101),g=n(100),u={},l={},d={},p=!0,h=!0,f=!1,E=null,C=null,B=g({},c,{getEvent:function(e,t){return u[e]?u[e][t]:null},getAllEvents:function(){var e={};return Object.keys(l).forEach(function(t){e[t]=[],Object.keys(l[t]).forEach(function(n){e[t].push(l[t][n])})}),e},getEventTimeRange:function(){return d},getLastCreated:function(){return E},getLastDeleted:function(){return C},hasMoreNewerEvents:function(){return p},hasMoreOlderEvents:function(){return h},hasReceived:function(){return f},dispatcherIndex:a.register(function(e){var t=e.type,n=e.data,o=!0;switch(t){case s.CREATE_EVENT:A(n,s.CREATE_EVENT);break;case s.RESTORE_DELETED_EVENT:A(n,s.CREATE_EVENT),C=null;break;case s.RECEIVE_EVENT:A(n);break;case s.DELETE_EVENT:i(n);break;case s.RECEIVE_EVENTS:0===Object.keys(l).length&&(l={}),r(n);var a=Object.keys(l);0===a.length&&(p=!1,h=!1),f=!0;break;case s.LOAD_MORE_NEWER_EVENTS:r(n),0===n.length&&(p=!1);break;case s.LOAD_MORE_OLDER_EVENTS:r(n),0===n.length&&(h=!1);break;default:o=!1}o&&B.emitChange()})});e.exports=B},1858:function(e,t,n){"use strict";e.exports=function(){if(!$.mockjax)return!1;var e="/platform/api";$.mockjax({url:e+"/events",type:"GET",responseText:[{from_time:"2015-03-12T07:18:33.540Z",repeated:!1,id:38,title:"B",full_day:!1,period:!0,description:null,created_at:"2015-03-12T07:16:37.068Z",updated_at:"2015-03-12T07:16:37.068Z",creator_id:6,to_time:"2015-03-12T07:18:33.540Z",repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,repeated_number:1,participants:[],team_participants:[{id:8}]},{from_time:"2015-04-27T07:52:20.632Z",repeated:!0,repeated_end_type:0,repeated_type:"Daily",repeated_frequency:1,id:39,title:"Repeated Test",full_day:!1,period:!0,description:null,created_at:"2015-03-12T07:50:23.269Z",updated_at:"2015-03-12T07:50:23.269Z",creator_id:6,to_time:"2015-05-06T07:52:20.632Z",repeated_on:'["Thu"]',repeated_by:"Month",repeated_times:10,repeated_end_date:null,repeated_number:56,participants:[{id:6}],team_participants:[]},{from_time:"2015-03-03T07:52:20.632Z",repeated:!0,repeated_end_type:0,repeated_type:"Daily",repeated_frequency:1,to_time:"2015-03-12T07:52:20.632Z",id:39,title:"Repeated Test",full_day:!1,period:!0,description:null,created_at:"2015-03-12T07:50:23.269Z",updated_at:"2015-03-12T07:50:23.269Z",creator_id:6,repeated_on:'["Thu"]',repeated_by:"Month",repeated_times:10,repeated_end_date:null,repeated_number:1,participants:[{id:6}],team_participants:[]},{from_time:"2015-04-27T02:00:00.000Z",repeated:!0,repeated_end_type:0,repeated_type:"Daily",repeated_frequency:1,id:35,title:"Stand up meeting",full_day:!1,period:!0,description:"ATE Stand up meeting",created_at:"2015-03-12T02:32:44.369Z",updated_at:"2015-03-12T02:32:44.369Z",creator_id:1,to_time:"2015-04-27T02:15:00.000Z",repeated_on:'["Thu"]',repeated_by:"Week",repeated_times:10,repeated_end_date:"2015-04-11T02:34:46.789Z",repeated_number:47,participants:[],team_participants:[{id:2}]},{from_time:"2015-03-12T02:00:00.000Z",repeated:!0,repeated_end_type:0,repeated_type:"Daily",repeated_frequency:1,to_time:"2015-03-12T02:15:00.000Z",id:35,title:"Stand up meeting",full_day:!1,period:!0,description:"ATE Stand up meeting",created_at:"2015-03-12T02:32:44.369Z",updated_at:"2015-03-12T02:32:44.369Z",creator_id:1,repeated_on:'["Thu"]',repeated_by:"Week",repeated_times:10,repeated_end_date:"2015-04-11T02:34:46.789Z",repeated_number:1,participants:[],team_participants:[{id:2}]}]}),$.mockjax({url:e+"/events/before",type:"GET",responseText:[{from_time:"2015-02-05T04:00:00.000Z",id:4,title:"Discuss about 0.2 release",full_day:!1,period:!0,description:'Discuss the tasks we should do on 0.2 release.\n\nEspecially about "task & issue tracking" function. Also about remaining IM issues and the priority.\n\nEveryone, please prepare your remaining ticket list before the meeting.\n\nWe can use PC to access Gitlab and check our issues.',created_at:"2015-02-05T02:54:05.356Z",updated_at:"2015-02-05T02:54:05.356Z",creator_id:1,to_time:"2015-02-05T05:00:00.000Z",repeated:!1,repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,participants:[{id:2},{id:1},{id:3},{id:4},{id:5},{id:6},{id:10}],team_participants:[]},{from_time:"2015-02-06T07:00:00.000Z",id:12,title:"Division of work for v0.2-alpha",full_day:!1,period:!0,description:"",created_at:"2015-02-06T04:32:42.970Z",updated_at:"2015-02-06T04:32:42.970Z",creator_id:1,to_time:"2015-02-06T08:00:00.000Z",repeated:!1,repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,participants:[{id:2},{id:1},{id:3},{id:4},{id:5},{id:6},{id:10},{id:12}],team_participants:[]},{from_time:"2015-02-27T08:26:00.000Z",id:14,title:"test",full_day:!1,period:!0,description:null,created_at:"2015-02-27T08:13:59.671Z",updated_at:"2015-02-27T08:13:59.671Z",creator_id:6,to_time:"2015-02-27T08:26:00.000Z",repeated:!1,repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,participants:[{id:6}],team_participants:[]},{from_time:"2015-02-27T08:27:00.000Z",id:15,title:"aaaa123123123",full_day:!1,period:!0,description:null,created_at:"2015-02-27T08:14:42.313Z",updated_at:"2015-02-27T08:14:42.313Z",creator_id:6,to_time:"2015-02-27T08:27:00.000Z",repeated:!1,repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,participants:[{id:6}],team_participants:[]},{from_time:"2015-02-28T03:08:41.205Z",id:16,title:"123123",full_day:!1,period:!0,description:"123123",created_at:"2015-02-28T03:07:06.816Z",updated_at:"2015-02-28T03:07:06.816Z",creator_id:6,to_time:"2015-02-28T03:08:41.205Z",repeated:!1,repeated_type:null,repeated_frequency:null,repeated_on:null,repeated_by:null,repeated_times:null,repeated_end_type:null,repeated_end_date:null,participants:[{id:6}],team_participants:[]}]}),$.mockjax({url:e+"/events/after",type:"GET",responseText:[]}),$.mockjax({url:e+"/events",type:"POST",responseText:[]})}()},1859:function(e,t,n){var A=n(1860);"string"==typeof A&&(A=[[e.id,A,""]]);n(348)(A,{})},1860:function(e,t,n){t=e.exports=n(347)(),t.push([e.id,".create-team{padding:0;margin:20px}.create-team-textfield{width:100%!important}",""])}});