<link rel="import" href="vote-element.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-action-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../elements/app-globals/app-globals.html">

<polymer-element name="vote-content" attributes="votes users vote_id">
    <template>
        <style type="text/css">
            paper-action-dialog::shadow #scroller {
                width : 800;
                height : 600
            }

            #voteAnsDialog {
                width: 600px;
            }
        </style>
        <app-globals id="globals"></app-globals>
        <!--<paper-action-dialog id="voteAnsDialog" heading="Vote" class="scrolling" role="dialog" backdrop="" autoclosedisabled="" layered="false" layout="" vertical="" aria-label="Title" tabindex="-1" style="position: fixed; outline: none; display: none;">-->
        <paper-action-dialog id="voteAnsDialog" heading="Vote" class="scrolling" role="dialog" layout="" vertical="" aria-label="Title" tabindex="-1" style="position: fixed; outline: none; display: none;">

            <core-ajax
                    id="ajaxAnsFinish"
                    method="post"
                    contentType="application/json"
                    url="/platform/votes/{{vote_id}}/{{user_id}}"></core-ajax>

            <template repeat="{{vote in votes}}">
                <vote-element description="{{vote.description}}" options="{{vote.options}}"></vote-element>
            </template>

            <div>
                <p>Finished vote</p>
                <div>
                    <template repeat="{{user in users.voted}}">
                        <p>{{user}}</p>
                    </template>
                </div>
                <p>Wait for vote</p>
                <div>
                    <template repeat="{{user in users.notVoted}}">
                        <p>{{user}}</p>
                    </template>
                </div>
            </div>


            <paper-button id="cancelButton" affirmative="" role="button" tabindex="0">Cancel</paper-button>
            <paper-button affirmative="" autofocus="" role="button" tabindex="0" on-tap="{{submitAns}}">Confirm</paper-button>

        </paper-action-dialog>
    </template>
    <script>
        Polymer('vote-content', {
            ready: function() {
                this.user_id = this.$.globals.values.currentUser.id;
            },

            submitAns : function() {
                var ajax = this.$.ajaxAnsFinish;
                ajax.go();
            }
        });

    </script>
</polymer-element>