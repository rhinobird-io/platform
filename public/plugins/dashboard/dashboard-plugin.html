<link rel="import" href="../../home-container.html">
<link rel="import" href="../../bower_components/ajax-file-input/ajax-file-input.html">
<link rel="import" href="../../elements/dashboard-records/dashboard-records.html">

<polymer-element name="dashboard-plugin">
    <template>
        <home-container>
            <div class="title">Dashboad</div>
            <core-ajax
                    id="addNotificationAjax"
                    method="post"
                    contentType="application/json"
                    body="{{notificationBody}}"
                    url="/platform/users/{{$.globals.values.currentUser.id}}/notifications"></core-ajax>
            <paper-button on-tap="{{addNotification}}">AddNotification</paper-button>
            <app-globals id="globals"></app-globals>
            <dashboard-records></dashboard-records>
        </home-container>
    </template>
    <script>
        Polymer("dashboard-plugin", {
            ready: function() {
                this.currentUser = this.shadowRoot.querySelector("home-container").currentUser;
            },

            addNotification: function() {
                this.notificationBody = JSON.stringify({"content": "test notification", "from_user_id": this.$.globals.values.currentUser.id });
                this.$.addNotificationAjax.go();
            }
        })
    </script>
</polymer-element>