<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-autogrow-textarea.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/polymer-filters/polymer-filters.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../home-container.html">
<link rel="import" href="../../elements/member-select/member-select.html">
<link rel="import" href="../../elements/datetime-input/datetime-input.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/core-pages/core-pages.html">
<link rel="import" href="../../bower_components/core-style/core-style.html">

<core-style id="calendar">
        paper-tabs::shadow #selectionBar{
            background-color: {{g.theme.accentBgColor}};
        }
        paper-tabs paper-tab::shadow #ink {
            color: {{g.theme.accentBgColor}};
        }
        paper-toggle-button::shadow #toggleBar[checked], paper-toggle-button::shadow paper-radio-button::shadow #onRadio {
            background-color: {{g.theme.accentBgColor}};
        }
        :host {
            background-color: white;
        }
        div.container {
            padding: 1em;
            overflow-y: auto;
            overflow-x: hidden;
        }

        div.timeline {
            position: relative;
            padding: 2em 0;
            margin-top: 2em;
            margin-bottom: 2em;
        }

        paper-fab {
            background-color: {{g.theme.mainBgColor}};
        }
        div.timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 18px;
            height: 100%;
            width: 4px;
            background-color: {{g.theme.thirdBgColor}};
        }

        paper-shadow.content {
            margin-left: 40px;
            border-radius: 0.25em;
            padding: 16px;
            cursor: pointer;
        }

        paper-shadow.content::shadow div#shadow-top::before {
            content: '';
            position: absolute;
            top: 16px;
            right: 100%;
            height: 0;
            width: 0;
            border: 7px solid black;
            border-color: transparent transparent white white;
            box-shadow: -1px 1px 1px 0 rgba(0, 0, 0, 0.26);
            transform-origin: 14px 14px;
            transform: rotate(45deg);
        }

        paper-shadow.content h2 {
            margin-top: 0;
        }

        .block {
            position: relative;
            margin: 2em 0;
        }

        p.time {
            color: grey;
        }

        p.description {
            margin-bottom: 0;
        }

        div.detail {
            padding: 60px;
            overflow-y: auto;
        }

        .main-button {
            position: absolute;
            top: 8px;
            left: 8px;
            z-index: 10000;
        }

        .tabs, .pages, .fullday {
            max-width: 150px;
        }

        .fullday {
            margin: 1em 0;
        }
</core-style>

<polymer-element name="schedule-list">
    <template>
        <core-style ref="calendar"></core-style>
        <core-animated-pages selected="0" transitions="hero-transition cross-fade-all" id="pages" flex>
            <section>
                <div class="container" fit>
                    <div class="timeline">
                        <template repeat="{{event, index in events}}">
                            <div layout horizontal class="block">
                                <div>
                                    <paper-fab mini icon="event" class="event"
                                               on-tap="{{select}}"></paper-fab>
                                </div>
                                <div hero hero-id="{{event.id}}">
                                    <paper-shadow z="1" class="content" on-tap="{{select}}">
                                        <h2>{{event.title}}</h2>

                                        <p class="time">{{event.time | date('HH:mm')}}</p>
                                        <paper-ripple fit></paper-ripple>
                                        <!--<p class="description">{{description}}</p>-->
                                    </paper-shadow>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </section>
            <section>
                <div hero hero-id="{{selected.id}}" class="detail" vertical layout fit center>
                    <paper-icon-button icon="arrow-back" class="main-button" on-tap="{{main}}"></paper-icon-button>
                    <div class="detail-content" vertical layout center>
                        <div>
                            <paper-input label="Title" floatingLabel value="{{selected.title}}"></paper-input>
                            <paper-input-decorator label="Description" floatingLabel id="decorator">
                                <paper-autogrow-textarea id="autogrowArea">
                                    <textarea id="textArea" wrap="virtual" value="{{selected.description}}"></textarea>
                                </paper-autogrow-textarea>
                            </paper-input-decorator>
                            <div center horizontal layout class="fullday">
                                <div flex>Full Day</div>
                                <paper-toggle-button checked="{{fullDay}}"></paper-toggle-button>
                            </div>
                            <paper-tabs selected="{{tabSelected}}" class="tabs">
                                <paper-tab>Period</paper-tab>
                                <paper-tab>Point</paper-tab>
                            </paper-tabs>
                            <core-pages selected="{{tabSelected}}" class="pages">
                                <div>
                                    <div layout horizontal justified end>
                                        <date-input label="From"></date-input>
                                        <template if="{{!fullDay}}">
                                            <time-input label=" "></time-input>
                                        </template>
                                    </div>
                                    <div layout horizontal justified end>
                                        <date-input label="To"></date-input>
                                        <template if="{{!fullDay}}">
                                            <time-input label=" "></time-input>
                                        </template>
                                    </div>
                                </div>
                                <div>
                                    <div layout horizontal justified end>
                                        <date-input label="Date"></date-input>
                                        <template if="{{!fullDay}}">
                                            <time-input label="Time"></time-input>
                                        </template>
                                    </div>
                                </div>
                            </core-pages>
                            <!--<member-select teamsUrl="/platform/teams_users"></member-select>-->
                        </div>
                    </div>
                </div>
            </section>
        </core-animated-pages>
    </template>
    <script>
        Polymer({
            tabSelected: 0,
            events: [
                {
                    id: "1",
                    title: "Event Title 1",
                    description: "Event description 1",
                    time: new Date()
                }, {
                    id: "2",
                    title: "Event Title 2",
                    description: "Event description 2",
                    time: new Date()
                }, {
                    id: "3",
                    title: "Event Title 3",
                    description: "Event description 3 a little long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long",
                    time: new Date()
                }, {
                    id: "4",
                    title: "Event Title 3",
                    description: "Event description 3 a little long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long",
                    time: new Date()
                }, {
                    id: "5",
                    title: "Event Title 3",
                    description: "Event description 3 a little long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long",
                    time: new Date()
                }, {
                    id: "6",
                    title: "Event Title 3",
                    description: "Event description 3 a little long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long",
                    time: new Date()
                }
            ],
            selectes: {},
            select: function (event, detail, target) {
                this.selected = target.templateInstance.model.event;
                var self = this;
                setTimeout(function () {
                    self.$.autogrowArea.update(self.$.textArea);
                    self.$.decorator.updateLabelVisibility(self.$.textArea.value);
                    self.$.pages.selected = 1;
                }, 100);

            },
            main: function () {
                this.$.pages.selected = 0;
            }
        });
    </script>
</polymer-element>

<polymer-element name="calendar-plugin">
    <template>
        <style>
            #timeline {
                position: relative;
                padding: 2em 0;
                margin-top: 2em;
                margin-bottom: 2em;
            }

            #timeline:before {
                content: '';
                position: absolute;
                top: 0;
                left: 18px;
                height: 100%;
                width: 4px;
                background: #d7e4ed;
            }
        </style>
        <home-container>
            <div class="title">Calendar</div>
            <schedule-list fit vertical layout></schedule-list>
            <!-- cd-timeline -->
        </home-container>
    </template>
    <script>
        Polymer({});
    </script>
</polymer-element>