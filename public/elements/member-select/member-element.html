<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">


<polymer-element name="member-element" attributes="user_id">
    <template>
        <style>
            .element {
                font-size: small;
                color:dimgrey;
            }
        </style>
        <core-ajax id="getGravatar"
                   url="/platform/gravatar/{{user_id}}"
                   handleAs="json"
                   on-core-response="{{handleResponse}}"></core-ajax>
        <div class="element" horizontal layout center>
            <img src="{{gravatar.url}}?d=identicon&s=20" />  <span style="margin: 2px">{{gravatar.username}}</span>
        </div>

    </template>
    <script>
        var memberCache = {};
        Polymer({
            domReady: function() {
                this.gravatar = memberCache[this.user_id];
                if(!this.gravatar){
                    this.$.getGravatar.go();
                }
            },
            handleResponse: function(event, detail, target) {
                this.gravatar = detail.response;
                memberCache[this.user_id] = detail.response;
            }
        });
    </script>
</polymer-element>