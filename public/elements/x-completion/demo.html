<html>

<head>
    <!-- 1. Load platform support before any code that touches the DOM. -->
    <script src="../../bower_components/webcomponentsjs/webcomponents.min.js"></script>

    <link rel="import" href="x-completion.html">
    <link rel="import" href="../../bower_components/paper-input/paper-input.html">
    <link rel="import" href="../../bower_components/paper-input/paper-autogrow-textarea.html">
</head>

<polymer-element name="demo-wrapper">
    <template>
        <paper-input-decorator>
            <paper-autogrow-textarea>
                <textarea id="input" on-input="{{inputing}}"></textarea>
            </paper-autogrow-textarea>
        </paper-input-decorator>
        <x-completion id="com" controller="{{$.input}}" controllerKeydownHandler="{{handler}}" on-select="{{activate}}">
            <template repeat="{{items}}">
                <div>{{name}}</div>
            </template>
        </x-completion>
    </template>
    <script>
        Polymer({
            items: [{name: "aaa"}, {name: "bbb"}, {name: "ccc"}, {name: "ddd"}],
            handler: function (e) {
                console.log("out keydown");
            },
            inputing: function (e, d, t) {
                if (t.value.substring(t.value.length - 1) === 'a') {
                    this.$.com.active = true;
                } else {
                    this.$.com.active = false;
                }
            },
            activate: function (e, d, t) {
                this.$.input.value += d.item.name;
            }
        });
    </script>
</polymer-element>
<body>
<div layout vertical fit style="width:640px; left:50%; margin: 25px 0 0 -320px">
    <demo-wrapper>
    </demo-wrapper>
</div>
</template>
</body>

</html>
