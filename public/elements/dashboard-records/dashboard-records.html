<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-item/core-item.html">
<link rel="import" href="../html-echo/html-echo.html">
<link rel="import" href="../../bower_components/polymer-filters/polymer-filters.html">
<link rel="import" href="../app-globals/app-globals.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-list/core-list.html">
<link rel="import" href="../member-select/member-element.html">
<link rel="import" href="../smart-time-display/smart-time-display.html">

<polymer-element name="dashboard-record" attributes="record">
    <template>
        <core-item>
            <div>
                <div horizontal layout center>
                    <member-element view="custom" userid="{{record.from_user_id}}" menu="true" borderRadius="100%">
                        <div class="title">
                            <smart-time-display 
                                from="{{record.created_at}}" 
                                to="{{record.created_at}}"
                                with_message="{{false}}">
                            </smart-time-display> 
                            <span>ago</span>
                        </div>
                        <div class="content">{{record.content}} 
                            <template if="{{record.has_link}}">
                                <a href="{{record.link_url}}">{{record.link_title}}</a>
                            </template>
                        </div>
                    </member-element>
                </div>
            </div>
        </core-item>
    </template>
    <script>
        Polymer();
    </script>
</polymer-element>

<polymer-element name="dashboard-records" attributes="record">
    <template>
        <style>
            core-list {
                *height: 300px;
                position: absolute;;
                top: 10px;
                bottom: 0;
                left: 10px;
                right: 0;
            }
            dashboard-record {
                
                padding: 10px;
            }
        </style>
        <app-globals id="globals"></app-globals>
        <template if="{{$.globals.values.currentUser}}">
            <core-ajax id="getDashboardRecord"
                    auto
                    url="/platform/users/{{$.globals.values.currentUser.id}}/dashboard_records"
                    handleAs="json"
                    response="{{records}}"></core-ajax>
        </template>
        <core-list data="{{records}}">
            <template>
                <dashboard-record record="{{model}}"></dashboard-record>
            </template>
        </core-list>
    </template>
    <script>
        Polymer({
        });
    </script>
</polymer-element>