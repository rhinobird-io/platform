<!DOCTYPE html>
<html>
<head>
    <!-- 1. Load platform support before any code that touches the DOM. -->
    <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <!-- 2. Load the component using an HTML Import -->
    <link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="bower_components/core-ajax/core-ajax.html">
    <link rel="import" href="bower_components/core-menu/core-menu.html">
    <link rel="import" href="bower_components/core-item/core-item.html">
    <link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
    <link rel="import" href="bower_components/core-drawer-panel/core-drawer-panel.html">
    <link rel="import" href="bower_components/core-scaffold/core-scaffold.html">
    <link rel="import" href="bower_components/paper-button/paper-button.html">
    <link rel="import" href="bower_components/paper-input/paper-input.html">
    <link rel="import" href="bower_components/paper-menu-button/paper-menu-button.html">
    <link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
    <link rel="import" href="bower_components/paper-dropdown/paper-dropdown.html">
    <link rel="import" href="bower_components/paper-item/paper-item.html">
    <link rel="import" href="bower_components/ajax-file-input/ajax-file-input.html">
    <link rel="import" href="bower_components/core-pages/core-pages.html">
    <link rel="import" href="bower_components/paper-shadow/paper-shadow.html">
    <link rel="import" href="bower_components/flatiron-director/flatiron-director.html">
    <style>
        div.inline {
            display: inline;
        }
        .open-below {
            top: 38px;
        }

  core-pages {
    width: 75%;
    height: 75%;
    border: none;
    -webkit-user-select: none;
    border-radius: 5px;
    transform: translateZ(0);
  }
  core-pages > div {
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: inherit;
    opacity: 0;
    -webkit-transform: translate3d(0, 50px, 0) scale(0.9);
    transform: translate3d(0, 50px, 0) scale(0.9);
    transform-origin: 50% 50%;
    transition: all 300ms cubic-bezier(.03,.56,.7,.98);
    font-size: 50px;
    background-color: white;
  }

  core-pages .core-selected {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
  }

  body /deep/ core-header-panel {
    fill: #fff;
  }


  core-menu {
  }
  @media all and (max-width: 480px) {
    .paper-shadow  {
      display: none;
    }
    core-pages {
      width: 100%;
      height: 100%;
    }
    core-pages > div {
      transition: none;
    }
  }
    </style>
</head>
<body unresolved fullbleed>
<template id="auto-bind" is="auto-binding">
<flatiron-director route="{{route}}" autoHash
                     on-director-route="{{routeChanged}}"></flatiron-director>
<core-scaffold fit>
<core-ajax
    auto='true'
    method="GET"
    url="/developer/plugins"
    handleAs="json"
    response="{{plugins}}"
    ></core-ajax>
    <core-header-panel navigation flex mode="seamed">
        <core-toolbar>
            <paper-menu-button>
                <paper-icon-button icon="menu" noink></paper-icon-button>
                <paper-dropdown class="dropdown open-below" >
                <core-menu class="menu">
                    <paper-item noink><a href='index.html'>Home</a></paper-item>
                    <paper-item noink><a href="pluginManager.html">Plugins</a></paper-item>
                </core-menu>
                </paper-dropdown>
            </paper-menu-button>
            <span>Plugins</span>
        </core-toolbar>
        <core-menu >
            <template repeat="{{plugin,  i in plugins}}">
                <core-item icon="{{plugin.icon}}" label="{{plugin.name}}"  active?="{{route == plugin.hash}}" class="{{ {'core-selected' : route == plugin.hash} | tokenList }}" > 
                <a href="#{{plugin.id}}"></a>
                </core-item>
            </template>
        </core-menu>
    </core-header-panel>
    <core-toolbar tool flex style='background-color: transparent;'>
        <div flex></div>
        <paper-icon-button icon="add" onclick='window.location.hash="Upload"'></paper-icon-button>
    </core-toolbar>
    <div layout horizontal center center-justified fit style="overflow-x: hidden;">
        <core-pages valueattr="hash"  selected="{{route}}" notap>
            <div hash="Upload" >
              <div><ajax-file-input url="/developer/upload" onsuccess="{{uploaded}}"></ajax-file-input></div>
            </div>
           <template repeat="{{plugin in plugins}}">
                <div hash="{{plugin.id}}" >
                <paper-shadow z="2"></paper-shadow>

                    Id: {{plugin.id}} <br/>
                    Name: {{plugin.name}}<br/>
                    Author: {{plugin.author}}<br/>
                    description: {{plugin.description}}<br/>
                    URL: {{plugin.url}}<br/>

            </template> 
        </core-pages>
    </div>
</core-scaffold>
</template>
<script>
    var autoBind= document.querySelector('#auto-bind');
    autoBind.uploaded = function(xhr){
        var newPlugin = JSON.parse(xhr.responseText);
        autoBind.plugins.push(newPlugin);
        autoBind.route = newPlugin.id;
    }
    autoBind.addEventListener('template-bound', function() {
        this.route = this.route || 'Upload'; // default route to "1".
    });
</script>
</body>
</html>